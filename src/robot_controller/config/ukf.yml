# ==============================================================================
# UKF Localization Configuration
# Fusion: Wheel Odometry + IMU
# ==============================================================================

frequency: 25
sensor_timeout: 0.1
two_d_mode: true
print_diagnostics: true

# Frame configuration
odom_frame: robot_0/odom
base_link_frame: dummy_base_link
world_frame: robot_0/odom
publish_tf: false

# ==============================================================================
# SENSOR 0: Wheel Odometry
# ==============================================================================
odom0: /robot_0/odom
odom0_config: [true,  true,  false,   # x, y, z position
               false, false, false,   # roll, pitch, yaw
               true,  true,  false,   # x_vel, y_vel, z_vel
               false, false, true,    # roll_vel, pitch_vel, yaw_vel
               false, false, false]   # x_acc, y_acc, z_acc
odom0_queue_size: 10
odom0_differential: false
odom0_relative: false

# Rejection thresholds (Mahalanobis distance)
odom0_pose_rejection_threshold: 5.0
odom0_twist_rejection_threshold: 2.0

# ==============================================================================
# SENSOR 1: IMU
# ==============================================================================
imu0: /robot_0/imu/data
imu0_config: [false, false, false,   # x, y, z position
              true,  true,  true,    # roll, pitch, yaw (orientation)
              false, false, false,   # x_vel, y_vel, z_vel
              true,  true,  true,    # roll_vel, pitch_vel, yaw_vel (angular velocity)
              true,  true,  false]   # x_acc, y_acc, z_acc (linear acceleration - only x,y in 2D)
imu0_queue_size: 10
imu0_remove_gravitational_acceleration: true
imu0_differential: false
imu0_relative: false

# IMU rejection thresholds
imu0_pose_rejection_threshold: 0.8
imu0_twist_rejection_threshold: 0.8
imu0_linear_acceleration_rejection_threshold: 0.8

# ==============================================================================
# PROCESS NOISE COVARIANCE (CRITICAL - prevents NaN)
# Order: x, y, z, roll, pitch, yaw, vx, vy, vz, vroll, vpitch, vyaw, ax, ay, az
# Increase values for faster convergence, decrease for smoother output
# ==============================================================================
process_noise_covariance: [0.05, 0,    0,    0,    0,    0,    0,     0,     0,    0,    0,    0,    0,    0,    0,
                           0,    0.05, 0,    0,    0,    0,    0,     0,     0,    0,    0,    0,    0,    0,    0,
                           0,    0,    0.06, 0,    0,    0,    0,     0,     0,    0,    0,    0,    0,    0,    0,
                           0,    0,    0,    0.03, 0,    0,    0,     0,     0,    0,    0,    0,    0,    0,    0,
                           0,    0,    0,    0,    0.03, 0,    0,     0,     0,    0,    0,    0,    0,    0,    0,
                           0,    0,    0,    0,    0,    0.06, 0,     0,     0,    0,    0,    0,    0,    0,    0,
                           0,    0,    0,    0,    0,    0,    0.025, 0,     0,    0,    0,    0,    0,    0,    0,
                           0,    0,    0,    0,    0,    0,    0,     0.025, 0,    0,    0,    0,    0,    0,    0,
                           0,    0,    0,    0,    0,    0,    0,     0,     0.04, 0,    0,    0,    0,    0,    0,
                           0,    0,    0,    0,    0,    0,    0,     0,     0,    0,    0.01, 0,    0,    0,    0,
                           0,    0,    0,    0,    0,    0,    0,     0,     0,    0,    0.01, 0,    0,    0,    0,
                           0,    0,    0,    0,    0,    0,    0,     0,     0,    0,    0,    0.02, 0,    0,    0,
                           0,    0,    0,    0,    0,    0,    0,     0,     0,    0,    0,    0,    0.01, 0,    0,
                           0,    0,    0,    0,    0,    0,    0,     0,     0,    0,    0,    0,    0,    0.01, 0,
                           0,    0,    0,    0,    0,    0,    0,     0,     0,    0,    0,    0,    0,    0,    0.015]

# ==============================================================================
# INITIAL ESTIMATE COVARIANCE (CRITICAL - prevents NaN at startup)
# Large values = fast convergence for measured variables
# Small values = slow convergence
# ==============================================================================
initial_estimate_covariance: [1e-9, 0,    0,    0,    0,    0,    0,    0,    0,    0,     0,     0,     0,    0,    0,
                              0,    1e-9, 0,    0,    0,    0,    0,    0,    0,    0,     0,     0,     0,    0,    0,
                              0,    0,    1e-9, 0,    0,    0,    0,    0,    0,    0,     0,     0,     0,    0,    0,
                              0,    0,    0,    1e-9, 0,    0,    0,    0,    0,    0,     0,     0,     0,    0,    0,
                              0,    0,    0,    0,    1e-9, 0,    0,    0,    0,    0,     0,     0,     0,    0,    0,
                              0,    0,    0,    0,    0,    1e-9, 0,    0,    0,    0,     0,     0,     0,    0,    0,
                              0,    0,    0,    0,    0,    0,    1e-9, 0,    0,    0,     0,     0,     0,    0,    0,
                              0,    0,    0,    0,    0,    0,    0,    1e-9, 0,    0,     0,     0,     0,    0,    0,
                              0,    0,    0,    0,    0,    0,    0,    0,    1e-9, 0,     0,     0,     0,    0,    0,
                              0,    0,    0,    0,    0,    0,    0,    0,    0,    1e-9,  0,     0,     0,    0,    0,
                              0,    0,    0,    0,    0,    0,    0,    0,    0,    0,     1e-9,  0,     0,    0,    0,
                              0,    0,    0,    0,    0,    0,    0,    0,    0,    0,     0,     1e-9,  0,    0,    0,
                              0,    0,    0,    0,    0,    0,    0,    0,    0,    0,     0,     0,     1e-9, 0,    0,
                              0,    0,    0,    0,    0,    0,    0,    0,    0,    0,     0,     0,     0,    1e-9, 0,
                              0,    0,    0,    0,    0,    0,    0,    0,    0,    0,     0,     0,     0,    0,    1e-9]

# ==============================================================================
# UKF PARAMETERS (CRITICAL for UKF)
# Controls sigma point spread
# ==============================================================================
alpha: 0.001
kappa: 0
beta: 2
